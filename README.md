
## Installation

```
npm i -g evm2term
```

## Description

Provides an executable `evm2term` that summarizes an AST stored in a json file.
Currently only there is a description file `egg-ast-description.js` giving support 
to the ASTs provided by the `egg` compiler used in the classes of the subject *[Language Processors](https://ull-esit-gradoii-pl.github.io/practicas/index.html)*:

For instance, for this Egg program:

```
➜ cat cat examples/summult.egg
```
```ruby
+(a,*(4,5))
```

The AST generated by the any parser  is usually a long JSON:
```
➜  eggc examples/summult.egg       
➜  evm2term git:(generic) ✗ cat examples/summult.json
```
```json
{
  "type": "apply",
  "operator": {
    "type": "word",
    "offset": 0,
    "lineBreaks": 0,
    "line": 1,
    "col": 1,
    "name": "+"
  },
  "args": [
    {
      "type": "word",
      "offset": 2,
      "lineBreaks": 0,
      "line": 1,
      "col": 3,
      "name": "a"
    },
    {
      "type": "apply",
      "operator": {
        "type": "word",
        "offset": 4,
        "lineBreaks": 0,
        "line": 1,
        "col": 5,
        "name": "*"
      },
      "args": [
        {
          "type": "value",
          "value": 4,
          "raw": "4"
        },
        {
          "type": "value",
          "value": 5,
          "raw": "5"
        }
      ]
    }
  ]
}
```

You can get the shape of the AST using `evm2term`:

```
✗ evm2term examples/summult.json
apply(op:word{"+"},args:[word{"a"},apply(op:word{"*"},args:[value{4},value{5}])])
```

## The Term Language to Summarize ASTs

`Term` is a DSL to summarize ASTs. Here is an attempt to describe the language:

```
term -> ('NAME' ':')? 'TYPE' '(' term (',' term)* ')'
  | leaf
leaf -> ('NAME' ':')? 'TYPE' ('{' 'ATTRIBUTE' '}')?
```

* Token `'NAME'` is the name of the child in the parent node, 
* Token `'TYPE'` represents the type of the node, 
* The token `'ATTRIBUTE'` is a  string containing a description of a single attribute of the node. 

* Only the type of the node is shown
* Only one selected attribute of a leaf is shown (Between curly brackets)
* Array n-ary nodes are allowed (and they go between brackets)

## Future Work

The algorithm used can work with almost any AST.
Write more AST descriptions for different JS transpilers (esprima, babel, etc.)